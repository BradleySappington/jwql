{% extends "base.html" %}

{% block preamble %}

	<title>Archived {{ inst }} Images - JWQL</title>

	<!-- Custom styles and scripts for this template -->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">

	<script type="text/javascript">
	function make_proposal_array() {
		$.ajax({
			url: 'http://127.0.0.1:8000/ajax/FGS/archive/',
			success: function(data){

        		// Add content to the proposal array div
        		for (var i = 0; i < data.thumbnails.proposals.length; i++) {

        			// Parse out useful variables
        			inst = data.inst;
        			prop = data.thumbnails.proposals[i];
        			thumb = data.thumbnails.thumbnail_paths[i];
        			n = data.thumbnails.num_files[i];

        			// Build div content
        			content = '<div class="proposal text-center">';
        			content += '<a href="/' + inst + '/archive/' + prop + '/" id="proposal' + i + '" proposal="' + prop + '"';
        			content += '<span class="helper"></span><img src="{{ static("thumbnails/") }}' + thumb + '" alt="" width=100%>';
        			content += '<div class="proposal-color-fill" ></div>';
        			content += '<div class="proposal-info">';
        			content += '<h3>' + prop + '</h3>';
        			content += '<h6>' + n + ' Files</h6>';
        			content += '</div></a></div>';

        			// Add the content to the div
        			$("#proposal-array")[0].innerHTML += content;

				// Replace loading screen with the proposal array div
            	document.getElementById("loading").style.display = "none";
            	document.getElementById("proposal-array").style.display = "block";
        		};
		}});
	};
	</script>


{% endblock %}

{% block content %}

	<style type="text/css">
		div#proposal-array { display: none; }
		div#loading { text-align:center; z-index: 1000; }
	</style>

    <main role="main" class="container">

    	<h3 id='title'>Archived {{ inst }} Images</h3>

    	<p id='img_show_count'>Showing {{ num_proposals }}/{{ num_proposals }} proposals
    		<a href="https://jwst-docs.stsci.edu/display/JDAT/File+Naming+Conventions+and+Data+Products" target="_blank" style="color: black">
    			<span class="help-tip mx-2">i</span>
    		</a>
    	</p>

    	<hr>

    	<!-- Filter and sort options -->
		<div class="d-flex flex-row">
			<!-- Search Bar -->
		    <div class="input-group mb-3">
			  <input id='search_box' type="text" class="form-control" placeholder="Search" aria-label="Search by proposal" oninput="search('{{ num_proposals }}');">
			  <div class="input-group-append">
			  	<span class="input-group-text"><span class="fas fa-search" aria-hidden="true"></span></span>
			    <!--<button class="btn btn-primary" type="button"><span class="fas fa-search" aria-hidden="true"></span></button>-->

			  </div>
			</div>

			<!-- Sort Options -->
			<div class="mx-4 mr-5 ml-auto">
		    	Sort by:
		    	<span class="dropdown">
				  <button class="btn btn-primary dropdown-toggle ml-3" type="button" id="sort_dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Ascending</button>
				  <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
				  	<a class="dropdown-item" href="#" onclick="sort_by_proposals('Ascending');">Ascending</a>
			    	<a class="dropdown-item" href="#" onclick="sort_by_proposals('Descending');">Descending</a>
				  </div>
				</span>
			</div>
		</div>

		<hr>

		<!-- Loading animation -->
		<div id="loading">
			<div class="lds-css ng-scope">
				<div style="width:100%;height:100%" class="lds-magnify">
					<div>
						<div>
							<div>
							</div>
							<div>
							</div>
						</div>
					</div>
				</div>
				<br>Loading ...
			</div>
		</div>

		<!-- Display the data -->
		<div id='proposal-array'></div>
		<script>
			make_proposal_array();
		</script>
		<a id="no_proposals_msg" style='display: none'>No proposals match the search criteria.</a>

	</main>

{% endblock %}